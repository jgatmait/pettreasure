<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Room 11 – The Lost Pet Registry</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<h1>Chapter 11 – The Lost Pet Registry</h1>
<p class="subtitle">
    Your pet senses the final shard… but it's stored somewhere unsafe.
</p>

<img src="res/pet_stage4.png" alt="Adult Blob" class="pet-img">

<!-- Locked message -->
<div id="locked" class="card" style="display:none;">
    <p class="locked">
        Access denied. Missing correct key.<br>
        (Try solving the previous room first!)
    </p>
</div>

<!-- Main content -->
<div id="content" class="card" style="display:none;">
    <p>
        Your pet finds an old *Pet Registry* API.  
        “If only we could access my file… maybe it contains our last shard.”
    </p>

    <p><strong>Pet Info (loaded from API):</strong></p>
    <pre id="petData">Loading...</pre>

    <p>
        <em>Hint: DevTools → Network → Look at the request made to <code>res/pets/</code>.  
        The ID might be… predictable.</em>
    </p>

    <p>
        Try changing <code>?id=</code> in the API URL to access another pet’s data.
    </p>

    <!-- Final clue (hidden) -->
    <div id="finalClue" style="display:none; margin-top:20px;">
        <p><strong>You found the forgotten pet entry!</strong></p>
        <pre>final_evolution.html?final=blobQueen</pre>
    </div>

</div>

<a class="btn" href="index.html">Back Home</a>

<script>
// Check key
const params = new URLSearchParams(window.location.search);
if (params.get("key") !== "idorTime") {
    document.getElementById("locked").style.display = "block";
} else {
    document.getElementById("content").style.display = "block";

    // Default ID: user's pet = id=1
    const id = params.get("id") || 1;

    fetch(`res/pets/pet${id}.json`)
        .then(r => r.json())
        .then(data => {
            document.getElementById("petData").innerText = JSON.stringify(data, null, 2);

            // The "secret" pet is ID 5
            if (id == 5) {
                document.getElementById("finalClue").style.display = "block";
            }
        })
        .catch(() => {
            document.getElementById("petData").innerText = "Error loading pet data.";
        });
}
</script>

</body>
</html>
